<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Planilha de Fechamento de Caixa</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; color: #333; }
    h1 { text-align: center; }
    .container { max-width: 1000px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,.1); }
    label { display: block; margin-top: 10px; font-weight: bold; }
    input, select, button { padding: 8px; margin-top: 5px; width: 100%; box-sizing: border-box; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
    th { background: #f0f0f0; }
    .right { text-align: right; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Planilha de Fechamento de Caixa</h1>
    
    <label for="cat">Categoria</label>
    <select id="cat">
      <option value="cartao">Cartão</option>
      <option value="cartao_parcelado">Cartão (Parcelado)</option>
      <option value="pix_chave">PIX (Chave)</option>
      <option value="pix_maquina">PIX (Máquina)</option>
      <option value="convenio">Convênio</option>
      <option value="prazo">Prazo</option>
      <option value="sangria_saida">Sangria/Saída</option>
    </select>

    <label for="valor">Valor (R$)</label>
    <input type="number" id="valor" step="0.01" value="0.00" />

    <button id="addBtn">Adicionar</button>

    <table>
      <thead>
        <tr>
          <th>Categoria</th>
          <th class="right">Valor</th>
        </tr>
      </thead>
      <tbody id="tbody"></tbody>
      <tfoot>
        <tr><th>Total Cartão</th><th class="right" id="t_cartao">R$ 0,00</th></tr>
        <tr><th>Total Cartão (Parcelado)</th><th class="right" id="t_cartao_parcelado">R$ 0,00</th></tr>
        <tr><th>Total PIX (Chave)</th><th class="right" id="t_pix_chave">R$ 0,00</th></tr>
        <tr><th>Total PIX (Máquina)</th><th class="right" id="t_pix_maquina">R$ 0,00</th></tr>
        <tr><th>Total Convênio</th><th class="right" id="t_convenio">R$ 0,00</th></tr>
        <tr><th>Total Prazo</th><th class="right" id="t_prazo">R$ 0,00</th></tr>
        <tr><th>Total Saídas</th><th class="right" id="t_sangria_saida">R$ 0,00</th></tr>
        <tr><th>Total de Entradas</th><th class="right" id="t_entradas">R$ 0,00</th></tr>
        <tr><th>Total de Saídas</th><th class="right" id="t_saidas">R$ 0,00</th></tr>
        <tr><th>Saldo Final</th><th class="right" id="t_saldo">R$ 0,00</th></tr>
      </tfoot>
    </table>
  </div>

  <script>
    const fmt = new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' });
    const $cat = document.getElementById('cat');
    const $valor = document.getElementById('valor');
    const $tbody = document.getElementById('tbody');

    const totals = {
      cartao: 0,
      cartao_parcelado: 0,
      pix_chave: 0,
      pix_maquina: 0,
      convenio: 0,
      prazo: 0,
      sangria_saida: 0,
    };

    let dados = [];

    function render(){
      $tbody.innerHTML = '';
      dados.forEach(d => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${d.cat}</td><td class="right">${fmt.format(d.valor)}</td>`;
        $tbody.appendChild(tr);
      });

      document.getElementById('t_cartao').textContent = fmt.format(totals.cartao);
      document.getElementById('t_cartao_parcelado').textContent = fmt.format(totals.cartao_parcelado);
      document.getElementById('t_pix_chave').textContent = fmt.format(totals.pix_chave);
      document.getElementById('t_pix_maquina').textContent = fmt.format(totals.pix_maquina);
      document.getElementById('t_convenio').textContent = fmt.format(totals.convenio);
      document.getElementById('t_prazo').textContent = fmt.format(totals.prazo);
      document.getElementById('t_sangria_saida').textContent = fmt.format(totals.sangria_saida);

      const entradas = totals.cartao + totals.cartao_parcelado + totals.pix_chave + totals.pix_maquina + totals.convenio + totals.prazo;
      const saidas = totals.sangria_saida;
      document.getElementById('t_entradas').textContent = fmt.format(entradas);
      document.getElementById('t_saidas').textContent = fmt.format(saidas);
      document.getElementById('t_saldo').textContent = fmt.format(entradas - saidas);
    }

    document.getElementById('addBtn').addEventListener('click', () => {
      let valor = parseFloat($valor.value);
      if(isNaN(valor) || valor <= 0){
        alert('Digite um valor válido.');
        return;
      }
      const categoria = $cat.value;
      dados.push({ cat: $cat.options[$cat.selectedIndex].text, valor });
      totals[categoria] += valor;
      render();
      $valor.value = '0.00';
    });
  </script>
</body>
</html>
